<div class="sidebar">
  <div class="nav-logo">Pok√©dex</div>
  <button class="nav-btn" [class.active]="!showFavoritesOnly" (click)="showPokedex()">
    <span>üìñ</span> Pok√©dex
  </button>
  <button class="nav-btn" [class.active]="showFavoritesOnly" (click)="showFavorites()">
    <span>‚≠ê</span> Favoritos
  </button>
</div>

<div class="container main-content">
  <h1>Mi Pok√©dex</h1>

  <!-- Barra de b√∫squeda -->
  <div class="search-section" *ngIf="!showFavoritesOnly">
    <div class="search-box">
      <input 
        type="text" 
        placeholder="Buscar Pok√©mon..." 
        [(ngModel)]="searchTerm"
        (input)="onSearch()"
        class="search-input"
      >
      <button (click)="clearSearch()" class="clear-btn" *ngIf="searchTerm">
        ‚úï
      </button>
    </div>
  </div>

  <!-- Favoritos como vista principal -->
  @if (showFavoritesOnly) {
    <div class="favorites-section">
      <h2>‚≠ê Tus Favoritos</h2>
      @if (favoritePokemons.length === 0) {
        <div class="no-results">
          <p>No tienes Pok√©mon favoritos a√∫n.</p>
        </div>
      }
      <div class="pokemon-grid favorites-grid">
        @for (pokemon of favoritePokemons; track pokemon.name) {
          <div class="favorite-card-wrapper">
            <app-pokemon-card 
              [pokemon]="pokemon"
              (cardClick)="onCardClick($event)"
            ></app-pokemon-card>
            <button class="favorite-btn active" (click)="toggleFavorite(pokemon)" title="Quitar de favoritos">
              ‚òÖ
            </button>
          </div>
        }
      </div>
    </div>
  }

  <!-- Pok√©dex normal -->
  @if (!showFavoritesOnly) {
    @if (loading) {
      <div class="loading">
        <p>Cargando Pok√©mon...</p>
      </div>
    }

    @if (error) {
      <div class="error">
        <p>{{ error }}</p>
        <button (click)="loadAllPokemonNames()">Intentar de nuevo</button>
      </div>
    }

    @if (!loading && !error && filteredPokemons.length > 0) {
      <div class="pokemon-grid">
        @for (pokemon of filteredPokemons; track pokemon.name) {
          <div class="favorite-card-wrapper">
            <app-pokemon-card 
              [pokemon]="pokemon"
              (cardClick)="onCardClick($event)"
            ></app-pokemon-card>
            <button 
              class="favorite-btn" 
              [class.active]="isFavorite(pokemon)" 
              (click)="toggleFavorite(pokemon); $event.stopPropagation()" 
              [title]="isFavorite(pokemon) ? 'Quitar de favoritos' : 'Agregar a favoritos'">
              {{ isFavorite(pokemon) ? '‚òÖ' : '‚òÜ' }}
            </button>
          </div>
        }
      </div>
    }

    @if (!loading && !error && filteredPokemons.length === 0 && searchTerm) {
      <div class="no-results">
        <p>No se encontraron Pok√©mon con "{{ searchTerm }}"</p>
        <button (click)="clearSearch()">Limpiar b√∫squeda</button>
      </div>
    }
  }

  <!-- Modal de detalles -->
  <app-pokemon-detail-modal
    [isOpen]="isModalOpen"
    [pokemonDetail]="selectedPokemon"
    (close)="closeModal()"
  ></app-pokemon-detail-modal>
</div>
